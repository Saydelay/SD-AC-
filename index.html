<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8" />
<title>Cheat-Scan nach Code suchen</title>
</head>
<body>
  <h2>ðŸ”Ž Scan-Code eingeben:</h2>
  <input type="text" id="scanCode" placeholder="z.B. YNBVP24N" />
  <button onclick="searchByScanCode()">Scan laden</button>

  <pre id="output" style="white-space: pre-wrap; border:1px solid #ccc; padding:10px; margin-top:10px;"></pre>

<script>
  const user = "saydelay";

  async function searchByScanCode() {
    const code = document.getElementById("scanCode").value.trim();
    const output = document.getElementById("output");
    output.textContent = `Suche nach Scan-Code: ${code}`;

    if (!code) {
      output.textContent = "Bitte einen Scan-Code eingeben.";
      return;
    }

    try {
      const response = await fetch(`https://api.github.com/users/${user}/gists?per_page=100`);
      if (!response.ok) {
        output.textContent = `Fehler beim Laden der Gists: ${response.status} ${response.statusText}`;
        return;
      }
      const gists = await response.json();
      output.textContent += `\n${gists.length} Gists geladen.`;

      // Suche Gist, der eine Datei scan_<code>.json hat
      const targetFilename = `scan_${code}.json`;
      const gist = gists.find(g =>
        Object.keys(g.files).some(filename => filename === targetFilename)
      );

      if (!gist) {
        output.textContent += `\nKein Scan mit dem Code '${code}' gefunden.`;
        return;
      }

      output.textContent += `\nGist gefunden: ${gist.html_url}`;

      // Dateiinhalt holen
      const file = gist.files[targetFilename];
      if (!file) {
        output.textContent += `\nDatei ${targetFilename} im Gist nicht gefunden.`;
        return;
      }

      output.textContent += `\n\nInhalt:\n${file.content}`;

    } catch (error) {
      output.textContent = `Fehler: ${error.message}`;
    }
  }
</script>
</body>
</html>
